<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Finn L. Busch">

<title>Business Decisions with Machine Learning Journal - Explaining Models with LIME</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/icons/favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Business Decisions with Machine Learning Journal</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-journal" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Journal</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-journal">    
        <li>
    <a class="dropdown-item" href="../../content/01_journal/01_ml_fund.html">
 <span class="dropdown-text">01 Machine Learning Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/ml.html">
 <span class="dropdown-text">02 Supervised ML - Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/auto_ml_1.html">
 <span class="dropdown-text">03 Automated Machine Learning Questions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/auto_ml_perf.html">
 <span class="dropdown-text">04/05 Automated Machine Learning (II) and Performance measures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/01_journal/lime.html">
 <span class="dropdown-text">06 Explaining Models with LIME</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Explaining Models with LIME</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Finn L. Busch </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>First, we load some libraries</p>
<div class="cell" data-hash="lime_cache/html/unnamed-chunk-1_28e1b4e4339c48e8ac38f0de62f87fbf">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(h2o)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(recipes)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(lime)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(rsample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We load the data and the trained model</p>
<div class="cell" data-hash="lime_cache/html/unnamed-chunk-3_67fbaac86d0cd1c46521081af94bf54f">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>product_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../product_backorders.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Rows: 19053 Columns: 23
#&gt; ── Column specification ────────────────────────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr  (7): potential_issue, deck_risk, oe_constraint, ppap_risk, stop_auto_bu...
#&gt; dbl (16): sku, national_inv, lead_time, in_transit_qty, forecast_3_month, fo...
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>split_obj<span class="ot">&lt;-</span> <span class="fu">initial_split</span>(product_data, <span class="at">prop =</span> <span class="fl">0.85</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>train_readable_tbl<span class="ot">&lt;-</span> <span class="fu">training</span>(split_obj)</span>
<span id="cb4-3"><a href="#cb4-3"></a>test_readable_tbl<span class="ot">&lt;-</span> <span class="fu">testing</span>(split_obj)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>recipe_obj <span class="ot">&lt;-</span> <span class="fu">recipe</span>(went_on_backorder <span class="sc">~</span>., <span class="at">data =</span> train_readable_tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="fu">prep</span>()</span>
<span id="cb4-8"><a href="#cb4-8"></a>train_tbl<span class="ot">&lt;-</span> <span class="fu">bake</span>(recipe_obj, <span class="at">new_data =</span> train_readable_tbl)</span>
<span id="cb4-9"><a href="#cb4-9"></a>test_tbl<span class="ot">&lt;-</span> <span class="fu">bake</span>(recipe_obj, <span class="at">new_data =</span> test_readable_tbl)</span>
<span id="cb4-10"><a href="#cb4-10"></a>automl_leader <span class="ot">&lt;-</span> <span class="fu">h2o.loadModel</span>(<span class="fu">paste</span>(<span class="st">"automl_models/"</span>, <span class="st">"StackedEnsemble_AllModels_3_AutoML_8_20230521_163641"</span>, <span class="at">sep=</span><span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We create the explainer object</p>
<div class="cell" data-hash="lime_cache/html/unnamed-chunk-4_193fce983b7894a8b1a9bc36e92aa11c">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>predictions_tbl <span class="ot">&lt;-</span> automl_leader <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">h2o.predict</span>(<span class="at">newdata =</span> <span class="fu">as.h2o</span>(test_tbl)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">as.tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb5-5"><a href="#cb5-5"></a>    test_tbl <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>      <span class="fu">select</span>(<span class="fu">everything</span>())</span>
<span id="cb5-7"><a href="#cb5-7"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: `as.tibble()` was deprecated in tibble 2.0.0.
#&gt; ℹ Please use `as_tibble()` instead.
#&gt; ℹ The signature and semantics have changed, see `?as_tibble`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">summary</span>(train_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;       sku           national_inv        lead_time      in_transit_qty    
#&gt;  Min.   :1112168   Min.   : -1440.0   Min.   : 0.000   Min.   :     0.0  
#&gt;  1st Qu.:1512764   1st Qu.:     3.0   1st Qu.: 4.000   1st Qu.:     0.0  
#&gt;  Median :1924199   Median :    11.0   Median : 8.000   Median :     0.0  
#&gt;  Mean   :2060809   Mean   :   399.1   Mean   : 7.711   Mean   :    51.7  
#&gt;  3rd Qu.:2828770   3rd Qu.:    63.0   3rd Qu.: 8.000   3rd Qu.:     0.0  
#&gt;  Max.   :3284775   Max.   :730722.0   Max.   :52.000   Max.   :170920.0  
#&gt;                                       NA's   :894                        
#&gt;  forecast_3_month   forecast_6_month   forecast_9_month    sales_1_month     
#&gt;  Min.   :     0.0   Min.   :     0.0   Min.   :      0.0   Min.   :     0.0  
#&gt;  1st Qu.:     0.0   1st Qu.:     0.0   1st Qu.:      0.0   1st Qu.:     0.0  
#&gt;  Median :     0.0   Median :     0.0   Median :      0.0   Median :     0.0  
#&gt;  Mean   :   191.8   Mean   :   361.3   Mean   :    523.6   Mean   :    61.1  
#&gt;  3rd Qu.:     9.0   3rd Qu.:    20.0   3rd Qu.:     30.0   3rd Qu.:     5.0  
#&gt;  Max.   :479808.0   Max.   :967776.0   Max.   :1418208.0   Max.   :186451.0  
#&gt;                                                                              
#&gt;  sales_3_month      sales_6_month       sales_9_month          min_bank       
#&gt;  Min.   :     0.0   Min.   :      0.0   Min.   :      0.0   Min.   :    0.00  
#&gt;  1st Qu.:     0.0   1st Qu.:      0.0   1st Qu.:      0.0   1st Qu.:    0.00  
#&gt;  Median :     1.0   Median :      3.0   Median :      5.0   Median :    0.00  
#&gt;  Mean   :   181.9   Mean   :    359.2   Mean   :    542.9   Mean   :   52.33  
#&gt;  3rd Qu.:    16.0   3rd Qu.:     32.0   3rd Qu.:     47.0   3rd Qu.:    3.00  
#&gt;  Max.   :550609.0   Max.   :1136154.0   Max.   :1759152.0   Max.   :85584.00  
#&gt;                                                                               
#&gt;  potential_issue pieces_past_due     perf_6_month_avg  perf_12_month_avg
#&gt;  No :16176       Min.   :    0.000   Min.   :-99.000   Min.   :-99.000  
#&gt;  Yes:   19       1st Qu.:    0.000   1st Qu.:  0.630   1st Qu.:  0.660  
#&gt;                  Median :    0.000   Median :  0.820   Median :  0.800  
#&gt;                  Mean   :    2.426   Mean   : -6.426   Mean   : -5.903  
#&gt;                  3rd Qu.:    0.000   3rd Qu.:  0.960   3rd Qu.:  0.950  
#&gt;                  Max.   :13824.000   Max.   :  1.000   Max.   :  1.000  
#&gt;                                                                         
#&gt;   local_bo_qty      deck_risk   oe_constraint ppap_risk   stop_auto_buy
#&gt;  Min.   :   0.000   No :12629   No :16190     No :14230   No :  555    
#&gt;  1st Qu.:   0.000   Yes: 3566   Yes:    5     Yes: 1965   Yes:15640    
#&gt;  Median :   0.000                                                      
#&gt;  Mean   :   0.967                                                      
#&gt;  3rd Qu.:   0.000                                                      
#&gt;  Max.   :1440.000                                                      
#&gt;                                                                        
#&gt;  rev_stop    went_on_backorder
#&gt;  No :16186   No :14291        
#&gt;  Yes:    9   Yes: 1904        
#&gt;                               
#&gt;                               
#&gt;                               
#&gt;                               
#&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>explainer <span class="ot">&lt;-</span> train_tbl <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>went_on_backorder) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">lime</span>(</span>
<span id="cb10-4"><a href="#cb10-4"></a>    <span class="at">model           =</span> automl_leader,</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="at">bin_continuous  =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="at">n_bins          =</span> <span class="dv">4</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="at">quantile_bins   =</span> <span class="cn">TRUE</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: in_transit_qty does not contain enough variance to use quantile
#&gt; binning. Using standard binning instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: pieces_past_due does not contain enough variance to use quantile
#&gt; binning. Using standard binning instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: local_bo_qty does not contain enough variance to use quantile binning.
#&gt; Using standard binning instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>explainer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; $model
#&gt; Model Details:
#&gt; ==============
#&gt; 
#&gt; H2OBinomialModel: stackedensemble
#&gt; Model ID:  StackedEnsemble_AllModels_3_AutoML_8_20230521_163641 
#&gt; Model Summary for Stacked Ensemble: 
#&gt;                                          key            value
#&gt; 1                          Stacking strategy cross_validation
#&gt; 2       Number of base models (used / total)            19/56
#&gt; 3           # GBM base models (used / total)             4/24
#&gt; 4       # XGBoost base models (used / total)            12/23
#&gt; 5           # DRF base models (used / total)              2/2
#&gt; 6  # DeepLearning base models (used / total)              0/6
#&gt; 7           # GLM base models (used / total)              1/1
#&gt; 8                      Metalearner algorithm              GLM
#&gt; 9         Metalearner fold assignment scheme           Random
#&gt; 10                        Metalearner nfolds                5
#&gt; 11                   Metalearner fold_column               NA
#&gt; 12        Custom metalearner hyperparameters             None
#&gt; 
#&gt; 
#&gt; H2OBinomialMetrics: stackedensemble
#&gt; ** Reported on training data. **
#&gt; 
#&gt; MSE:  0.02057401
#&gt; RMSE:  0.1434364
#&gt; LogLoss:  0.08208601
#&gt; Mean Per-Class Error:  0.0497189
#&gt; AUC:  0.9941161
#&gt; AUCPR:  0.9671187
#&gt; Gini:  0.9882322
#&gt; 
#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:
#&gt;          No  Yes    Error       Rate
#&gt; No     8697  123 0.013946  =123/8820
#&gt; Yes      99 1059 0.085492   =99/1158
#&gt; Totals 8796 1182 0.022249  =222/9978
#&gt; 
#&gt; Maximum Metrics: Maximum metrics at their respective thresholds
#&gt;                         metric threshold       value idx
#&gt; 1                       max f1  0.406675    0.905128 183
#&gt; 2                       max f2  0.350978    0.913486 198
#&gt; 3                 max f0point5  0.594378    0.932273 135
#&gt; 4                 max accuracy  0.450843    0.978252 173
#&gt; 5                max precision  0.991528    1.000000   0
#&gt; 6                   max recall  0.019785    1.000000 354
#&gt; 7              max specificity  0.991528    1.000000   0
#&gt; 8             max absolute_mcc  0.450843    0.892793 173
#&gt; 9   max min_per_class_accuracy  0.249626    0.959184 230
#&gt; 10 max mean_per_class_accuracy  0.249626    0.959298 230
#&gt; 11                     max tns  0.991528 8820.000000   0
#&gt; 12                     max fns  0.991528 1156.000000   0
#&gt; 13                     max fps  0.000538 8820.000000 399
#&gt; 14                     max tps  0.019785 1158.000000 354
#&gt; 15                     max tnr  0.991528    1.000000   0
#&gt; 16                     max fnr  0.991528    0.998273   0
#&gt; 17                     max fpr  0.000538    1.000000 399
#&gt; 18                     max tpr  0.019785    1.000000 354
#&gt; 
#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`
#&gt; H2OBinomialMetrics: stackedensemble
#&gt; ** Reported on validation data. **
#&gt; 
#&gt; MSE:  0.04754009
#&gt; RMSE:  0.2180369
#&gt; LogLoss:  0.1567978
#&gt; Mean Per-Class Error:  0.1314887
#&gt; AUC:  0.9630208
#&gt; AUCPR:  0.7754713
#&gt; Gini:  0.9260415
#&gt; 
#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:
#&gt;          No Yes    Error       Rate
#&gt; No     2017  84 0.039981   =84/2101
#&gt; Yes      64 223 0.222997    =64/287
#&gt; Totals 2081 307 0.061977  =148/2388
#&gt; 
#&gt; Maximum Metrics: Maximum metrics at their respective thresholds
#&gt;                         metric threshold       value idx
#&gt; 1                       max f1  0.348138    0.750842 187
#&gt; 2                       max f2  0.207765    0.806870 227
#&gt; 3                 max f0point5  0.701665    0.743455  95
#&gt; 4                 max accuracy  0.348138    0.938023 187
#&gt; 5                max precision  0.935452    0.961538  16
#&gt; 6                   max recall  0.015971    1.000000 355
#&gt; 7              max specificity  0.981947    0.999524   0
#&gt; 8             max absolute_mcc  0.348138    0.716027 187
#&gt; 9   max min_per_class_accuracy  0.141145    0.895470 261
#&gt; 10 max mean_per_class_accuracy  0.111502    0.900435 275
#&gt; 11                     max tns  0.981947 2100.000000   0
#&gt; 12                     max fns  0.981947  287.000000   0
#&gt; 13                     max fps  0.000628 2101.000000 399
#&gt; 14                     max tps  0.015971  287.000000 355
#&gt; 15                     max tnr  0.981947    0.999524   0
#&gt; 16                     max fnr  0.981947    1.000000   0
#&gt; 17                     max fpr  0.000628    1.000000 399
#&gt; 18                     max tpr  0.015971    1.000000 355
#&gt; 
#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`
#&gt; H2OBinomialMetrics: stackedensemble
#&gt; ** Reported on cross-validation data. **
#&gt; ** 5-fold cross-validation on training data (Metrics computed for combined holdout predictions) **
#&gt; 
#&gt; MSE:  0.04925558
#&gt; RMSE:  0.221936
#&gt; LogLoss:  0.1644987
#&gt; Mean Per-Class Error:  0.157046
#&gt; AUC:  0.9551036
#&gt; AUCPR:  0.7637539
#&gt; Gini:  0.9102073
#&gt; 
#&gt; Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:
#&gt;           No  Yes    Error        Rate
#&gt; No     11629  542 0.044532  =542/12171
#&gt; Yes      441 1195 0.269560   =441/1636
#&gt; Totals 12070 1737 0.071196  =983/13807
#&gt; 
#&gt; Maximum Metrics: Maximum metrics at their respective thresholds
#&gt;                         metric threshold        value idx
#&gt; 1                       max f1  0.360175     0.708568 203
#&gt; 2                       max f2  0.130029     0.787346 289
#&gt; 3                 max f0point5  0.606611     0.739550 128
#&gt; 4                 max accuracy  0.568958     0.932570 139
#&gt; 5                max precision  0.991347     1.000000   0
#&gt; 6                   max recall  0.002831     1.000000 393
#&gt; 7              max specificity  0.991347     1.000000   0
#&gt; 8             max absolute_mcc  0.360175     0.668447 203
#&gt; 9   max min_per_class_accuracy  0.127434     0.893846 290
#&gt; 10 max mean_per_class_accuracy  0.117550     0.895407 295
#&gt; 11                     max tns  0.991347 12171.000000   0
#&gt; 12                     max fns  0.991347  1633.000000   0
#&gt; 13                     max fps  0.000607 12171.000000 399
#&gt; 14                     max tps  0.002831  1636.000000 393
#&gt; 15                     max tnr  0.991347     1.000000   0
#&gt; 16                     max fnr  0.991347     0.998166   0
#&gt; 17                     max fpr  0.000607     1.000000 399
#&gt; 18                     max tpr  0.002831     1.000000 393
#&gt; 
#&gt; Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`
#&gt; Cross-Validation Metrics Summary: 
#&gt;                 mean        sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid
#&gt; accuracy    0.928466  0.005435   0.936537   0.926902   0.930855   0.922390
#&gt; auc         0.955626  0.006403   0.960230   0.954218   0.952812   0.947285
#&gt; err         0.071534  0.005435   0.063463   0.073098   0.069145   0.077610
#&gt; err_count 197.800000 20.216330 173.000000 197.000000 186.000000 226.000000
#&gt; f0point5    0.692233  0.032865   0.750151   0.674495   0.682095   0.684184
#&gt;           cv_5_valid
#&gt; accuracy    0.925647
#&gt; auc         0.963584
#&gt; err         0.074353
#&gt; err_count 207.000000
#&gt; f0point5    0.670241
#&gt; 
#&gt; ---
#&gt;                         mean        sd cv_1_valid cv_2_valid cv_3_valid
#&gt; precision           0.677743  0.044793   0.756098   0.650000   0.666667
#&gt; r2                  0.528928  0.019686   0.555933   0.524767   0.519346
#&gt; recall              0.761629  0.025818   0.727273   0.794212   0.751678
#&gt; residual_deviance 907.867900 85.196600 880.987240 874.298400 868.992250
#&gt; rmse                0.221595  0.006610   0.220455   0.220256   0.217597
#&gt; specificity         0.950968  0.009372   0.966457   0.944211   0.953177
#&gt;                    cv_4_valid cv_5_valid
#&gt; precision            0.668281   0.647668
#&gt; r2                   0.504636   0.539956
#&gt; recall               0.756164   0.778816
#&gt; residual_deviance 1059.364600 855.697000
#&gt; rmse                 0.233041   0.216628
#&gt; specificity          0.946211   0.944783
#&gt; 
#&gt; $preprocess
#&gt; function (x) 
#&gt; x
#&gt; &lt;bytecode: 0x564b563e15d0&gt;
#&gt; &lt;environment: 0x564b563d5af8&gt;
#&gt; 
#&gt; $bin_continuous
#&gt; [1] TRUE
#&gt; 
#&gt; $n_bins
#&gt; [1] 4
#&gt; 
#&gt; $quantile_bins
#&gt; [1] TRUE
#&gt; 
#&gt; $use_density
#&gt; [1] TRUE
#&gt; 
#&gt; $feature_type
#&gt;               sku      national_inv         lead_time    in_transit_qty 
#&gt;         "numeric"         "numeric"         "numeric"         "numeric" 
#&gt;  forecast_3_month  forecast_6_month  forecast_9_month     sales_1_month 
#&gt;         "numeric"         "numeric"         "numeric"         "numeric" 
#&gt;     sales_3_month     sales_6_month     sales_9_month          min_bank 
#&gt;         "numeric"         "numeric"         "numeric"         "numeric" 
#&gt;   potential_issue   pieces_past_due  perf_6_month_avg perf_12_month_avg 
#&gt;          "factor"         "numeric"         "numeric"         "numeric" 
#&gt;      local_bo_qty         deck_risk     oe_constraint         ppap_risk 
#&gt;         "numeric"          "factor"          "factor"          "factor" 
#&gt;     stop_auto_buy          rev_stop 
#&gt;          "factor"          "factor" 
#&gt; 
#&gt; $bin_cuts
#&gt; $bin_cuts$sku
#&gt;      0%     25%     50%     75%    100% 
#&gt; 1112168 1512764 1924199 2828770 3284775 
#&gt; 
#&gt; $bin_cuts$national_inv
#&gt;     0%    25%    50%    75%   100% 
#&gt;  -1440      3     11     63 730722 
#&gt; 
#&gt; $bin_cuts$lead_time
#&gt;   0%  25%  50% 100% 
#&gt;    0    4    8   52 
#&gt; 
#&gt; $bin_cuts$in_transit_qty
#&gt; [1]      0  42730  85460 128190 170920
#&gt; 
#&gt; $bin_cuts$forecast_3_month
#&gt;     0%    75%   100% 
#&gt;      0      9 479808 
#&gt; 
#&gt; $bin_cuts$forecast_6_month
#&gt;     0%    75%   100% 
#&gt;      0     20 967776 
#&gt; 
#&gt; $bin_cuts$forecast_9_month
#&gt;      0%     75%    100% 
#&gt;       0      30 1418208 
#&gt; 
#&gt; $bin_cuts$sales_1_month
#&gt;     0%    75%   100% 
#&gt;      0      5 186451 
#&gt; 
#&gt; $bin_cuts$sales_3_month
#&gt;     0%    50%    75%   100% 
#&gt;      0      1     16 550609 
#&gt; 
#&gt; $bin_cuts$sales_6_month
#&gt;      0%     50%     75%    100% 
#&gt;       0       3      32 1136154 
#&gt; 
#&gt; $bin_cuts$sales_9_month
#&gt;      0%     50%     75%    100% 
#&gt;       0       5      47 1759152 
#&gt; 
#&gt; $bin_cuts$min_bank
#&gt;    0%   75%  100% 
#&gt;     0     3 85584 
#&gt; 
#&gt; $bin_cuts$potential_issue
#&gt; NULL
#&gt; 
#&gt; $bin_cuts$pieces_past_due
#&gt; [1]     0  3456  6912 10368 13824
#&gt; 
#&gt; $bin_cuts$perf_6_month_avg
#&gt;     0%    25%    50%    75%   100% 
#&gt; -99.00   0.63   0.82   0.96   1.00 
#&gt; 
#&gt; $bin_cuts$perf_12_month_avg
#&gt;     0%    25%    50%    75%   100% 
#&gt; -99.00   0.66   0.80   0.95   1.00 
#&gt; 
#&gt; $bin_cuts$local_bo_qty
#&gt; [1]    0  360  720 1080 1440
#&gt; 
#&gt; $bin_cuts$deck_risk
#&gt; NULL
#&gt; 
#&gt; $bin_cuts$oe_constraint
#&gt; NULL
#&gt; 
#&gt; $bin_cuts$ppap_risk
#&gt; NULL
#&gt; 
#&gt; $bin_cuts$stop_auto_buy
#&gt; NULL
#&gt; 
#&gt; $bin_cuts$rev_stop
#&gt; NULL
#&gt; 
#&gt; 
#&gt; $feature_distribution
#&gt; $feature_distribution$sku
#&gt; 
#&gt;         1         2         3         4 
#&gt; 0.2500154 0.2500154 0.2499537 0.2500154 
#&gt; 
#&gt; $feature_distribution$national_inv
#&gt; 
#&gt;         1         2         3         4 
#&gt; 0.2747144 0.2259957 0.2498919 0.2493980 
#&gt; 
#&gt; $feature_distribution$lead_time
#&gt; 
#&gt;         1         2         3 
#&gt; 0.3005249 0.4119173 0.2323557 
#&gt; 
#&gt; $feature_distribution$in_transit_qty
#&gt; 
#&gt;            1            2            4 
#&gt; 9.998148e-01 1.234949e-04 6.174745e-05 
#&gt; 
#&gt; $feature_distribution$forecast_3_month
#&gt; 
#&gt;         1         2 
#&gt; 0.7517752 0.2482248 
#&gt; 
#&gt; $feature_distribution$forecast_6_month
#&gt; 
#&gt;         1         2 
#&gt; 0.7534424 0.2465576 
#&gt; 
#&gt; $feature_distribution$forecast_9_month
#&gt; 
#&gt;         1         2 
#&gt; 0.7532572 0.2467428 
#&gt; 
#&gt; $feature_distribution$sales_1_month
#&gt; 
#&gt;         1         2 
#&gt; 0.7609756 0.2390244 
#&gt; 
#&gt; $feature_distribution$sales_3_month
#&gt; 
#&gt;         1         2         3 
#&gt; 0.5027478 0.2497684 0.2474838 
#&gt; 
#&gt; $feature_distribution$sales_6_month
#&gt; 
#&gt;         1         2         3 
#&gt; 0.5114542 0.2410003 0.2475455 
#&gt; 
#&gt; $feature_distribution$sales_9_month
#&gt; 
#&gt;         1         2         3 
#&gt; 0.5163939 0.2348873 0.2487187 
#&gt; 
#&gt; $feature_distribution$min_bank
#&gt; 
#&gt;         1         2 
#&gt; 0.7566533 0.2433467 
#&gt; 
#&gt; $feature_distribution$potential_issue
#&gt; 
#&gt;          No         Yes 
#&gt; 0.998826798 0.001173202 
#&gt; 
#&gt; $feature_distribution$pieces_past_due
#&gt; 
#&gt;            1            2            4 
#&gt; 9.998765e-01 6.174745e-05 6.174745e-05 
#&gt; 
#&gt; $feature_distribution$perf_6_month_avg
#&gt; 
#&gt;         1         2         3         4 
#&gt; 0.2599568 0.2583513 0.2326644 0.2490275 
#&gt; 
#&gt; $feature_distribution$perf_12_month_avg
#&gt; 
#&gt;         1         2         3         4 
#&gt; 0.2824328 0.2251930 0.2610065 0.2313677 
#&gt; 
#&gt; $feature_distribution$local_bo_qty
#&gt; 
#&gt;            1            2            3            4 
#&gt; 9.994443e-01 2.469898e-04 6.174745e-05 2.469898e-04 
#&gt; 
#&gt; $feature_distribution$deck_risk
#&gt; 
#&gt;        No       Yes 
#&gt; 0.7798086 0.2201914 
#&gt; 
#&gt; $feature_distribution$oe_constraint
#&gt; 
#&gt;           No          Yes 
#&gt; 0.9996912627 0.0003087373 
#&gt; 
#&gt; $feature_distribution$ppap_risk
#&gt; 
#&gt;        No       Yes 
#&gt; 0.8786663 0.1213337 
#&gt; 
#&gt; $feature_distribution$stop_auto_buy
#&gt; 
#&gt;         No        Yes 
#&gt; 0.03426984 0.96573016 
#&gt; 
#&gt; $feature_distribution$rev_stop
#&gt; 
#&gt;           No          Yes 
#&gt; 0.9994442729 0.0005557271 
#&gt; 
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "data_frame_explainer" "explainer"            "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>explanation <span class="ot">&lt;-</span> test_tbl <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">slice</span>(<span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">select</span>(<span class="sc">-</span>went_on_backorder) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  lime<span class="sc">::</span><span class="fu">explain</span>(</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="at">explainer =</span> explainer,</span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="at">n_labels   =</span> <span class="dv">1</span>,</span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="at">n_features =</span> <span class="dv">8</span>,</span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="at">n_permutations =</span> <span class="dv">5000</span>,</span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="at">kernel_width   =</span> <span class="dv">1</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>explanation <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">as.tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">select</span>(feature<span class="sc">:</span>prediction) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["feature"],"name":[1],"type":["chr"],"align":["left"]},{"label":["feature_value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["feature_weight"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["feature_desc"],"name":[4],"type":["chr"],"align":["left"]},{"label":["data"],"name":[5],"type":["list"],"align":["right"]},{"label":["prediction"],"name":[6],"type":["list"],"align":["right"]}],"data":[{"1":"national_inv","2":"1","3":"0.22503263","4":"national_inv <= 3","5":"<named list [22]>","6":"<named list [2]>"},{"1":"forecast_6_month","2":"20","3":"-0.14536737","4":"forecast_6_month <= 20","5":"<named list [22]>","6":"<named list [2]>"},{"1":"local_bo_qty","2":"0","3":"-0.12001980","4":"local_bo_qty <= 360","5":"<named list [22]>","6":"<named list [2]>"},{"1":"rev_stop","2":"1","3":"-0.14059568","4":"rev_stop = No","5":"<named list [22]>","6":"<named list [2]>"},{"1":"sku","2":"1138666","3":"0.08138651","4":"sku <= 1512764","5":"<named list [22]>","6":"<named list [2]>"},{"1":"min_bank","2":"0","3":"-0.07649424","4":"min_bank <= 3","5":"<named list [22]>","6":"<named list [2]>"},{"1":"sales_1_month","2":"2","3":"-0.07538003","4":"sales_1_month <= 5","5":"<named list [22]>","6":"<named list [2]>"},{"1":"forecast_9_month","2":"30","3":"-0.06757424","4":"forecast_9_month <= 30","5":"<named list [22]>","6":"<named list [2]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now can recreate what “plot_features” achieves</p>
<div class="cell" data-hash="lime_cache/html/unnamed-chunk-5_4a2f2ee03964305e1a3f3c50470b5d11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>explanation <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">as.tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["case"],"name":[2],"type":["chr"],"align":["left"]},{"label":["label"],"name":[3],"type":["chr"],"align":["left"]},{"label":["label_prob"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["model_r2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["model_intercept"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["model_prediction"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["feature"],"name":[8],"type":["chr"],"align":["left"]},{"label":["feature_value"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["feature_weight"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["feature_desc"],"name":[11],"type":["chr"],"align":["left"]},{"label":["data"],"name":[12],"type":["list"],"align":["right"]},{"label":["prediction"],"name":[13],"type":["list"],"align":["right"]}],"data":[{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"national_inv","9":"1","10":"0.22503263","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"forecast_6_month","9":"20","10":"-0.14536737","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"local_bo_qty","9":"0","10":"-0.12001980","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"rev_stop","9":"1","10":"-0.14059568","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"sku","9":"1138666","10":"0.08138651","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"min_bank","9":"0","10":"-0.07649424","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"sales_1_month","9":"2","10":"-0.07538003","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"Yes","4":"0.9677938","5":"0.4774129","6":"0.6388111","7":"0.3197989","8":"forecast_9_month","9":"30","10":"-0.06757424","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>case_1 <span class="ot">&lt;-</span> explanation <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">filter</span>(case <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># recreated plot features</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>theme_lime <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>    <span class="fu">theme</span>(</span>
<span id="cb20-9"><a href="#cb20-9"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb20-10"><a href="#cb20-10"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">15</span>),</span>
<span id="cb20-11"><a href="#cb20-11"></a>      <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-12"><a href="#cb20-12"></a>      <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-13"><a href="#cb20-13"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-14"><a href="#cb20-14"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-15"><a href="#cb20-15"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-16"><a href="#cb20-16"></a>      <span class="at">legend.position =</span> <span class="st">'bottom'</span>,</span>
<span id="cb20-17"><a href="#cb20-17"></a>      <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">15</span>, <span class="st">'pt'</span>),</span>
<span id="cb20-18"><a href="#cb20-18"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">2</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb20-19"><a href="#cb20-19"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb20-20"><a href="#cb20-20"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb20-21"><a href="#cb20-21"></a>      ...</span>
<span id="cb20-22"><a href="#cb20-22"></a>    )</span>
<span id="cb20-23"><a href="#cb20-23"></a>}</span>
<span id="cb20-24"><a href="#cb20-24"></a></span>
<span id="cb20-25"><a href="#cb20-25"></a>description <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb20-26"><a href="#cb20-26"></a>desc_width <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">nchar</span>(description)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-27"><a href="#cb20-27"></a>description <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">format</span>(description, <span class="at">width =</span> desc_width), case_1<span class="sc">$</span>feature_desc)</span>
<span id="cb20-28"><a href="#cb20-28"></a>case_1<span class="sc">$</span>description <span class="ot">&lt;-</span> <span class="fu">factor</span>(description, <span class="at">levels =</span> description[<span class="fu">order</span>(<span class="fu">abs</span>(case_1<span class="sc">$</span>feature_weight))])</span>
<span id="cb20-29"><a href="#cb20-29"></a>case_1<span class="sc">$</span><span class="st">`</span><span class="at">Explanation fit</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">format</span>(case_1<span class="sc">$</span>model_r2, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb20-30"><a href="#cb20-30"></a>case_1<span class="sc">$</span>probability <span class="ot">&lt;-</span> <span class="fu">format</span>(case_1<span class="sc">$</span>label_prob, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="fu">ggplot</span>(case_1) <span class="sc">+</span> </span>
<span id="cb20-32"><a href="#cb20-32"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case <span class="sc">+</span> label  <span class="sc">+</span> probability <span class="sc">+</span> <span class="st">`</span><span class="at">Explanation fit</span><span class="st">`</span>, <span class="at">labeller =</span> label_both, <span class="at">scales =</span> <span class="st">'free_y'</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33"></a>  <span class="fu">geom_col</span>(<span class="fu">aes_</span>(<span class="sc">~</span>description, <span class="sc">~</span>feature_weight))<span class="sc">+</span> </span>
<span id="cb20-34"><a href="#cb20-34"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35"></a>  <span class="fu">theme_lime</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: `aes_()` was deprecated in ggplot2 3.0.0.
#&gt; ℹ Please use tidy evaluation idioms with `aes()`</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="lime_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="lime_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>In a similar fashion, we can recreate the “plot_explanations” function</p>
<div class="cell" data-hash="lime_cache/html/unnamed-chunk-6_0688b7965e3a51f616370e1b911e3fe2">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>explanation <span class="ot">&lt;-</span> test_tbl <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">select</span>(<span class="sc">-</span>went_on_backorder) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  lime<span class="sc">::</span><span class="fu">explain</span>(</span>
<span id="cb22-5"><a href="#cb22-5"></a>    <span class="at">explainer =</span> explainer,</span>
<span id="cb22-6"><a href="#cb22-6"></a>    <span class="at">n_labels   =</span> <span class="dv">1</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>    <span class="at">n_features =</span> <span class="dv">8</span>,</span>
<span id="cb22-8"><a href="#cb22-8"></a>    <span class="at">n_permutations =</span> <span class="dv">5000</span>,</span>
<span id="cb22-9"><a href="#cb22-9"></a>    <span class="at">kernel_width   =</span> <span class="fl">0.5</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
#&gt; 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>explanation <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">as.tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["case"],"name":[2],"type":["chr"],"align":["left"]},{"label":["label"],"name":[3],"type":["chr"],"align":["left"]},{"label":["label_prob"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["model_r2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["model_intercept"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["model_prediction"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["feature"],"name":[8],"type":["chr"],"align":["left"]},{"label":["feature_value"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["feature_weight"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["feature_desc"],"name":[11],"type":["chr"],"align":["left"]},{"label":["data"],"name":[12],"type":["list"],"align":["right"]},{"label":["prediction"],"name":[13],"type":["list"],"align":["right"]}],"data":[{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"oe_constraint","9":"1.00","10":"0.47839483","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"rev_stop","9":"1.00","10":"0.27355110","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"forecast_6_month","9":"360.00","10":"-0.15560058","11":"20 < forecast_6_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"local_bo_qty","9":"0.00","10":"0.14947412","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"potential_issue","9":"1.00","10":"-0.09732243","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"sales_3_month","9":"108.00","10":"-0.08609785","11":"16 < sales_3_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"sales_1_month","9":"30.00","10":"-0.08111937","11":"5 < sales_1_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"1","3":"No","4":"0.5944935","5":"0.2082875","6":"0.10664960","7":"0.5142322","8":"sku","9":"1115453.00","10":"-0.07369718","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"local_bo_qty","9":"0.00","10":"-0.33963822","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"national_inv","9":"0.00","10":"0.21987739","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"forecast_6_month","9":"7.00","10":"-0.12664502","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"sku","9":"1118984.00","10":"0.07654827","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"sales_1_month","9":"1.00","10":"-0.07467831","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"forecast_9_month","9":"9.00","10":"-0.06848880","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"min_bank","9":"0.00","10":"-0.06845331","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"2","3":"Yes","4":"0.8833903","5":"0.4759138","6":"0.73214361","7":"0.3041684","8":"forecast_3_month","9":"4.00","10":"-0.04649723","11":"forecast_3_month <= 9","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"local_bo_qty","9":"0.00","10":"-0.31193396","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"national_inv","9":"0.00","10":"-0.22254039","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"forecast_6_month","9":"5.00","10":"0.13421451","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"in_transit_qty","9":"0.00","10":"-0.10470044","11":"in_transit_qty <= 42730","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"sales_1_month","9":"0.00","10":"0.08097435","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"min_bank","9":"0.00","10":"0.07955190","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"sku","9":"1120247.00","10":"-0.06874765","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"3","3":"No","4":"0.5049900","5":"0.4814170","6":"1.03999980","7":"0.6930818","8":"forecast_9_month","9":"5.00","10":"0.06626370","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"national_inv","9":"64.00","10":"-0.21451686","11":"63 < national_inv","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"potential_issue","9":"1.00","10":"-0.16696296","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"forecast_6_month","9":"385.00","10":"0.13777509","11":"20 < forecast_6_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"in_transit_qty","9":"0.00","10":"0.16820288","11":"in_transit_qty <= 42730","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"sales_3_month","9":"319.00","10":"0.08486728","11":"16 < sales_3_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"min_bank","9":"94.00","10":"0.08152419","11":"3 < min_bank","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"sku","9":"1133746.00","10":"0.06963564","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"4","3":"Yes","4":"0.5161395","5":"0.4203368","6":"0.05328826","7":"0.2977368","8":"oe_constraint","9":"1.00","10":"0.08392325","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"oe_constraint","9":"1.00","10":"0.21580956","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"local_bo_qty","9":"0.00","10":"-0.06331209","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"forecast_6_month","9":"196.00","10":"-0.12832522","11":"20 < forecast_6_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"rev_stop","9":"1.00","10":"-0.16817325","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"sales_1_month","9":"19.00","10":"-0.07782984","11":"5 < sales_1_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"sku","9":"1135137.00","10":"-0.08158346","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"sales_3_month","9":"62.00","10":"-0.07624420","11":"16 < sales_3_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"5","3":"No","4":"0.5749549","5":"0.1967343","6":"0.93812965","7":"0.4872500","8":"min_bank","9":"43.00","10":"-0.07122119","11":"3 < min_bank","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"oe_constraint","9":"1.00","10":"0.18422346","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"forecast_6_month","9":"0.00","10":"0.13818290","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"sales_1_month","9":"4.00","10":"0.08147410","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"min_bank","9":"1.00","10":"0.08191330","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"sku","9":"1137457.00","10":"-0.07930739","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"national_inv","9":"12.00","10":"0.06757334","11":"11 < national_inv <= 63","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"forecast_9_month","9":"0.00","10":"0.06158421","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"6","3":"No","4":"0.6176075","5":"0.2343496","6":"0.31434543","7":"0.8986754","8":"potential_issue","9":"1.00","10":"0.04868601","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"national_inv","9":"1.00","10":"0.23200017","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"forecast_6_month","9":"20.00","10":"-0.14071191","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"min_bank","9":"0.00","10":"-0.08546447","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"sku","9":"1138666.00","10":"0.07441023","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"local_bo_qty","9":"0.00","10":"-0.07764218","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"sales_1_month","9":"2.00","10":"-0.07364722","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"forecast_9_month","9":"30.00","10":"-0.06928795","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"7","3":"Yes","4":"0.9677938","5":"0.4848906","6":"0.52349518","7":"0.3173212","8":"potential_issue","9":"1.00","10":"-0.06583068","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"national_inv","9":"2.00","10":"0.23488609","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"oe_constraint","9":"1.00","10":"-0.16439074","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"forecast_6_month","9":"6.00","10":"-0.13985975","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"min_bank","9":"0.00","10":"-0.08140718","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"potential_issue","9":"1.00","10":"0.06220018","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"sku","9":"1152635.00","10":"0.07535890","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"sales_1_month","9":"2.00","10":"-0.07471258","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"8","3":"Yes","4":"0.7360671","5":"0.4870763","6":"0.47411650","7":"0.3180939","8":"forecast_9_month","9":"6.00","10":"-0.06809754","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"oe_constraint","9":"1.00","10":"-0.29092922","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"national_inv","9":"2.00","10":"0.23015784","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"forecast_6_month","9":"300.00","10":"0.14749584","11":"20 < forecast_6_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"sales_1_month","9":"9.00","10":"0.08480942","11":"5 < sales_1_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"sku","9":"1152704.00","10":"0.07508616","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"local_bo_qty","9":"0.00","10":"-0.04188983","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"min_bank","9":"0.00","10":"-0.07049144","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"9","3":"Yes","4":"0.9315278","5":"0.4612305","6":"0.33505986","7":"0.5611817","8":"potential_issue","9":"1.00","10":"0.09188302","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"forecast_6_month","9":"10.00","10":"-0.14652600","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"rev_stop","9":"1.00","10":"-0.10715274","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"pieces_past_due","9":"0.00","10":"0.15338389","11":"pieces_past_due <= 3456","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"in_transit_qty","9":"0.00","10":"0.08297629","11":"in_transit_qty <= 42730","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"sales_1_month","9":"5.00","10":"-0.08186345","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"min_bank","9":"0.00","10":"-0.07265049","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"sku","9":"1153446.00","10":"0.07449957","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"10","3":"Yes","4":"0.8496665","5":"0.1885501","6":"0.35569064","7":"0.1656311","8":"potential_issue","9":"1.00","10":"-0.09272661","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"forecast_6_month","9":"40.00","10":"0.14135444","11":"20 < forecast_6_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"min_bank","9":"0.00","10":"-0.08307959","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"sku","9":"1154682.00","10":"0.08103110","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"forecast_9_month","9":"60.00","10":"0.07673420","11":"30 < forecast_9_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"local_bo_qty","9":"0.00","10":"-0.05850895","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"sales_1_month","9":"7.00","10":"0.06764451","11":"5 < sales_1_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"forecast_3_month","9":"20.00","10":"0.04379701","11":"9 < forecast_3_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"11","3":"Yes","4":"0.8378556","5":"0.2259390","6":"0.25457979","7":"0.4749306","8":"potential_issue","9":"1.00","10":"-0.04862187","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"national_inv","9":"0.00","10":"0.22414252","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"forecast_6_month","9":"30.00","10":"0.14320759","11":"20 < forecast_6_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"pieces_past_due","9":"30.00","10":"-0.13330238","11":"pieces_past_due <= 3456","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"oe_constraint","9":"1.00","10":"0.08827472","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"min_bank","9":"0.00","10":"-0.07788867","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"potential_issue","9":"1.00","10":"-0.05865378","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"sku","9":"1157380.00","10":"0.07037932","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"12","3":"Yes","4":"0.8467268","5":"0.4407840","6":"0.27720285","7":"0.4671552","8":"sales_1_month","9":"0.00","10":"-0.06620694","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"potential_issue","9":"1.00","10":"-0.13306548","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"rev_stop","9":"1.00","10":"0.14116883","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"forecast_6_month","9":"8.00","10":"-0.13662065","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"sales_1_month","9":"7.00","10":"0.07972320","11":"5 < sales_1_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"min_bank","9":"0.00","10":"-0.07213966","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"sku","9":"1158424.00","10":"0.06580756","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"forecast_9_month","9":"12.00","10":"-0.06019063","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"13","3":"Yes","4":"0.7455514","5":"0.1912803","6":"0.36152381","7":"0.2232043","8":"local_bo_qty","9":"0.00","10":"-0.02300274","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"national_inv","9":"1.00","10":"0.22534714","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"forecast_6_month","9":"0.00","10":"-0.13463841","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"local_bo_qty","9":"0.00","10":"0.05192108","11":"local_bo_qty <= 360","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"potential_issue","9":"1.00","10":"-0.07221803","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"sales_1_month","9":"0.00","10":"-0.07880153","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"min_bank","9":"1.00","10":"-0.07414182","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"sku","9":"1159573.00","10":"0.07047225","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"14","3":"Yes","4":"0.7490112","5":"0.4693438","6":"0.39230897","7":"0.3109053","8":"forecast_9_month","9":"3.00","10":"-0.06934431","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"national_inv","9":"0.00","10":"0.23115864","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"forecast_6_month","9":"12.00","10":"-0.13519158","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"sales_1_month","9":"4.00","10":"-0.07914131","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"in_transit_qty","9":"0.00","10":"0.05856680","11":"in_transit_qty <= 42730","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"sku","9":"1164037.00","10":"0.07679398","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"min_bank","9":"1.00","10":"-0.07437881","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"forecast_9_month","9":"15.00","10":"-0.06862492","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"15","3":"Yes","4":"0.9658802","5":"0.4847281","6":"0.29860161","7":"0.3444885","8":"perf_6_month_avg","9":"0.07","10":"0.03670404","11":"perf_6_month_avg <= 0.63","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"in_transit_qty","9":"0.00","10":"-0.36062755","11":"in_transit_qty <= 42730","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"national_inv","9":"0.00","10":"0.22477006","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"forecast_6_month","9":"18.00","10":"-0.14037463","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"oe_constraint","9":"1.00","10":"0.04659544","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"rev_stop","9":"1.00","10":"0.13904127","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"sku","9":"1164887.00","10":"0.07957854","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"min_bank","9":"1.00","10":"-0.07722898","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"16","3":"Yes","4":"0.6029067","5":"0.4531169","6":"0.49781838","7":"0.3377302","8":"sales_1_month","9":"0.00","10":"-0.07184230","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"oe_constraint","9":"1.00","10":"0.20990644","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"national_inv","9":"0.00","10":"-0.22893358","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"forecast_6_month","9":"1.00","10":"0.13623565","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"rev_stop","9":"1.00","10":"0.15309847","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"sales_1_month","9":"0.00","10":"0.08170825","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"min_bank","9":"1.00","10":"0.08080225","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"sku","9":"1165655.00","10":"-0.07681789","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"17","3":"No","4":"0.8242246","5":"0.4893388","6":"0.25835960","7":"0.6830882","8":"forecast_9_month","9":"1.00","10":"0.06872899","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"national_inv","9":"1.00","10":"0.23127125","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"forecast_6_month","9":"0.00","10":"-0.13763221","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"pieces_past_due","9":"0.00","10":"-0.15269460","11":"pieces_past_due <= 3456","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"sales_1_month","9":"1.00","10":"-0.08019398","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"sku","9":"1167914.00","10":"0.07084496","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"min_bank","9":"0.00","10":"-0.07054915","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"in_transit_qty","9":"1.00","10":"0.07762006","11":"in_transit_qty <= 42730","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"18","3":"Yes","4":"0.8322563","5":"0.4866576","6":"0.44044162","7":"0.3168528","8":"forecast_9_month","9":"0.00","10":"-0.06225515","11":"forecast_9_month <= 30","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"forecast_6_month","9":"19.00","10":"-0.14582220","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"in_transit_qty","9":"0.00","10":"0.04340975","11":"in_transit_qty <= 42730","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"sales_1_month","9":"2.00","10":"-0.08176071","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"min_bank","9":"2.00","10":"-0.07612298","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"potential_issue","9":"1.00","10":"-0.08077127","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"sku","9":"1169924.00","10":"0.06901179","11":"sku <= 1512764","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"forecast_9_month","9":"38.00","10":"0.05908864","11":"30 < forecast_9_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"19","3":"Yes","4":"0.5409674","5":"0.2217278","6":"0.40736071","7":"0.2403519","8":"forecast_3_month","9":"19.00","10":"0.04595812","11":"9 < forecast_3_month","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"rev_stop","9":"1.00","10":"-0.31783704","11":"rev_stop = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"national_inv","9":"0.00","10":"0.22399536","11":"national_inv <= 3","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"forecast_6_month","9":"10.00","10":"-0.13709093","11":"forecast_6_month <= 20","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"pieces_past_due","9":"0.00","10":"0.18480705","11":"pieces_past_due <= 3456","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"oe_constraint","9":"1.00","10":"-0.13711041","11":"oe_constraint = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"potential_issue","9":"1.00","10":"-0.06012880","11":"potential_issue = No","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"sales_1_month","9":"0.00","10":"-0.08112758","11":"sales_1_month <= 5","12":"<named list [22]>","13":"<named list [2]>"},{"1":"classification","2":"20","3":"Yes","4":"0.8034203","5":"0.4210411","6":"0.67477512","7":"0.2717612","8":"min_bank","9":"1.00","10":"-0.07852153","11":"min_bank <= 3","12":"<named list [22]>","13":"<named list [2]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>n_cases <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">as.numeric</span>(explanation<span class="sc">$</span>case))</span>
<span id="cb25-2"><a href="#cb25-2"></a>explanation<span class="sc">$</span>case <span class="ot">&lt;-</span> <span class="fu">factor</span>(explanation<span class="sc">$</span>case, <span class="at">levels =</span> <span class="fu">as.character</span>(<span class="fu">sort</span>(n_cases)))</span>
<span id="cb25-3"><a href="#cb25-3"></a>explanation<span class="sc">$</span>feature_desc <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb25-4"><a href="#cb25-4"></a>  explanation<span class="sc">$</span>feature_desc,</span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(explanation<span class="sc">$</span>feature_desc[<span class="fu">order</span>(explanation<span class="sc">$</span>feature, explanation<span class="sc">$</span>feature_value)]))</span>
<span id="cb25-6"><a href="#cb25-6"></a>)</span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="fu">ggplot</span>(explanation, <span class="fu">aes_</span>(<span class="sc">~</span>case, <span class="sc">~</span>feature_desc)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes_</span>(<span class="at">fill =</span> <span class="sc">~</span>feature_weight)) <span class="sc">+</span> </span>
<span id="cb25-9"><a href="#cb25-9"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">'Case'</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="fu">scale_y_discrete</span>(<span class="st">'Feature'</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="st">'Feature</span><span class="sc">\n</span><span class="st">weight'</span>, <span class="at">low =</span> <span class="st">'firebrick'</span>, <span class="at">mid =</span> <span class="st">'#f7f7f7'</span>, <span class="at">high =</span> <span class="st">'steelblue'</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  <span class="fu">theme_lime</span>()<span class="sc">+</span> </span>
<span id="cb25-13"><a href="#cb25-13"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">'grey60'</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb25-14"><a href="#cb25-14"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-15"><a href="#cb25-15"></a>        <span class="at">legend.position =</span> <span class="st">'right'</span>,</span>
<span id="cb25-16"><a href="#cb25-16"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb25-17"><a href="#cb25-17"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
#&gt; ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="lime_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="lime_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"loop":true,"openEffect":"zoom","descPosition":"bottom","selector":".lightbox","closeEffect":"zoom"});</script>



</body></html>